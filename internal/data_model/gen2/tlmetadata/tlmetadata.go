// Copyright 2025 V Kontakte LLC
//
// This Source Code Form is subject to the terms of the Mozilla Public
// License, v. 2.0. If a copy of the MPL was not distributed with this
// file, You can obtain one at https://mozilla.org/MPL/2.0/.

// Code generated by vktl/cmd/tlgen2; DO NOT EDIT.
package tlmetadata

import (
	"context"
	"time"

	"github.com/VKCOM/statshouse/internal/data_model/gen2/internal"
	"github.com/VKCOM/statshouse/internal/vkgo/basictl"
	"github.com/VKCOM/statshouse/internal/vkgo/rpc"
)

type (
	CreateEntityEvent                    = internal.MetadataCreateEntityEvent
	CreateMappingEvent                   = internal.MetadataCreateMappingEvent
	CreateMetricEvent                    = internal.MetadataCreateMetricEvent
	EditEntityEvent                      = internal.MetadataEditEntityEvent
	EditEntitynew                        = internal.MetadataEditEntitynew
	EditMetricEvent                      = internal.MetadataEditMetricEvent
	Event                                = internal.MetadataEvent
	EventBytes                           = internal.MetadataEventBytes
	GetEntity                            = internal.MetadataGetEntity
	GetHistoryShortInfo                  = internal.MetadataGetHistoryShortInfo
	GetInvertMapping                     = internal.MetadataGetInvertMapping
	GetInvertMappingResponse             = internal.MetadataGetInvertMappingResponse
	GetInvertMappingResponse0            = internal.MetadataGetInvertMappingResponse0
	GetInvertMappingResponseKeyNotExists = internal.MetadataGetInvertMappingResponseKeyNotExists
	GetJournalResponsenew                = internal.MetadataGetJournalResponsenew
	GetJournalResponsenewBytes           = internal.MetadataGetJournalResponsenewBytes
	GetJournalnew                        = internal.MetadataGetJournalnew
	GetMapping                           = internal.MetadataGetMapping
	GetMappingResponse                   = internal.MetadataGetMappingResponse
	GetMappingResponse0                  = internal.MetadataGetMappingResponse0
	GetMappingResponseCreated            = internal.MetadataGetMappingResponseCreated
	GetMappingResponseFloodLimitError    = internal.MetadataGetMappingResponseFloodLimitError
	GetMappingResponseKeyNotExists       = internal.MetadataGetMappingResponseKeyNotExists
	GetMetrics                           = internal.MetadataGetMetrics
	GetMetricsResponse                   = internal.MetadataGetMetricsResponse
	GetNewMappings                       = internal.MetadataGetNewMappings
	GetNewMappingsResponse               = internal.MetadataGetNewMappingsResponse
	GetTagMappingBootstrap               = internal.MetadataGetTagMappingBootstrap
	HistoryShortResponse                 = internal.MetadataHistoryShortResponse
	HistoryShortResponseEvent            = internal.MetadataHistoryShortResponseEvent
	MetricOld                            = internal.MetadataMetricOld
	PutBootstrapEvent                    = internal.MetadataPutBootstrapEvent
	PutMapping                           = internal.MetadataPutMapping
	PutMappingEvent                      = internal.MetadataPutMappingEvent
	PutMappingResponse                   = internal.MetadataPutMappingResponse
	PutTagMappingBootstrap               = internal.MetadataPutTagMappingBootstrap
	ResetFlood                           = internal.MetadataResetFlood
	ResetFlood2                          = internal.MetadataResetFlood2
	ResetFloodResponse                   = internal.MetadataResetFloodResponse
	ResetFloodResponse2                  = internal.MetadataResetFloodResponse2
	VectorEvent                          = internal.VectorMetadataEvent
	VectorEventBytes                     = internal.VectorMetadataEventBytes
	VectorHistoryShortResponseEvent      = internal.VectorMetadataHistoryShortResponseEvent
	VectorMetricOld                      = internal.VectorMetadataMetricOld

	GetTagMappingBootstrap__Result = internal.StatshouseGetTagMappingBootstrapResult
	PutTagMappingBootstrap__Result = internal.StatshousePutTagMappingBootstrapResult
)

type Client struct {
	Client  rpc.Client
	Network string // should be either "tcp4" or "unix"
	Address string
	ActorID int64         // should be >0 for routing via rpc-proxy
	Timeout time.Duration // set to extra.CustomTimeoutMs, if not already set
}

func (c *Client) EditEntitynew(ctx context.Context, args EditEntitynew, extra *rpc.InvokeReqExtra, ret *Event) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.FunctionName = "metadata.editEntitynew"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.editEntitynew", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.editEntitynew", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.editEntitynew", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) GetEntity(ctx context.Context, args GetEntity, extra *rpc.InvokeReqExtra, ret *Event) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.ReadOnly = true
	req.FunctionName = "metadata.getEntity"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.getEntity", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.getEntity", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.getEntity", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) GetHistoryShortInfo(ctx context.Context, args GetHistoryShortInfo, extra *rpc.InvokeReqExtra, ret *HistoryShortResponse) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.FunctionName = "metadata.getHistoryShortInfo"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.getHistoryShortInfo", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.getHistoryShortInfo", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.getHistoryShortInfo", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) GetInvertMapping(ctx context.Context, args GetInvertMapping, extra *rpc.InvokeReqExtra, ret *GetInvertMappingResponse) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.ReadOnly = true
	req.FunctionName = "metadata.getInvertMapping"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.getInvertMapping", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.getInvertMapping", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.getInvertMapping", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) GetJournalnew(ctx context.Context, args GetJournalnew, extra *rpc.InvokeReqExtra, ret *GetJournalResponsenew) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.ReadOnly = true
	req.FunctionName = "metadata.getJournalnew"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.getJournalnew", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.getJournalnew", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.getJournalnew", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) GetMapping(ctx context.Context, args GetMapping, extra *rpc.InvokeReqExtra, ret *GetMappingResponse) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.FunctionName = "metadata.getMapping"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.getMapping", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.getMapping", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.getMapping", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) GetMetrics(ctx context.Context, args GetMetrics, extra *rpc.InvokeReqExtra, ret *GetMetricsResponse) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.ReadOnly = true
	req.FunctionName = "metadata.getMetrics"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.getMetrics", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.getMetrics", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.getMetrics", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) GetNewMappings(ctx context.Context, args GetNewMappings, extra *rpc.InvokeReqExtra, ret *GetNewMappingsResponse) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.ReadOnly = true
	req.FunctionName = "metadata.getNewMappings"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.getNewMappings", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.getNewMappings", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.getNewMappings", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) GetTagMappingBootstrap(ctx context.Context, args GetTagMappingBootstrap, extra *rpc.InvokeReqExtra, ret *GetTagMappingBootstrap__Result) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.FunctionName = "metadata.getTagMappingBootstrap"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.getTagMappingBootstrap", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.getTagMappingBootstrap", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.getTagMappingBootstrap", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) PutMapping(ctx context.Context, args PutMapping, extra *rpc.InvokeReqExtra, ret *PutMappingResponse) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.FunctionName = "metadata.putMapping"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.putMapping", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.putMapping", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.putMapping", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) PutTagMappingBootstrap(ctx context.Context, args PutTagMappingBootstrap, extra *rpc.InvokeReqExtra, ret *PutTagMappingBootstrap__Result) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.FunctionName = "metadata.putTagMappingBootstrap"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.putTagMappingBootstrap", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.putTagMappingBootstrap", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.putTagMappingBootstrap", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) ResetFlood(ctx context.Context, args ResetFlood, extra *rpc.InvokeReqExtra, ret *ResetFloodResponse) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.FunctionName = "metadata.resetFlood"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.resetFlood", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.resetFlood", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.resetFlood", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

func (c *Client) ResetFlood2(ctx context.Context, args ResetFlood2, extra *rpc.InvokeReqExtra, ret *ResetFloodResponse2) (err error) {
	req := c.Client.GetRequest()
	req.ActorID = c.ActorID
	req.FunctionName = "metadata.resetFlood2"
	if extra != nil {
		req.Extra = extra.RequestExtra
		req.FailIfNoConnection = extra.FailIfNoConnection
	}
	rpc.UpdateExtraTimeout(&req.Extra, c.Timeout)
	req.Body, err = args.WriteBoxedGeneral(req.Body)
	if err != nil {
		return internal.ErrorClientWrite("metadata.resetFlood2", err)
	}
	resp, err := c.Client.Do(ctx, c.Network, c.Address, req)
	if extra != nil && resp != nil {
		extra.ResponseExtra = resp.Extra
	}
	defer c.Client.PutResponse(resp)
	if err != nil {
		return internal.ErrorClientDo("metadata.resetFlood2", c.Network, c.ActorID, c.Address, err)
	}
	if ret != nil {
		resp.Body, err = args.ReadResult(resp.Body, ret)
		if err != nil {
			return internal.ErrorClientReadResult("metadata.resetFlood2", c.Network, c.ActorID, c.Address, err)
		}
	}
	return nil
}

type Handler struct {
	EditEntitynew          func(ctx context.Context, args EditEntitynew) (Event, error)                                   // metadata.editEntitynew
	GetEntity              func(ctx context.Context, args GetEntity) (Event, error)                                       // metadata.getEntity
	GetHistoryShortInfo    func(ctx context.Context, args GetHistoryShortInfo) (HistoryShortResponse, error)              // metadata.getHistoryShortInfo
	GetInvertMapping       func(ctx context.Context, args GetInvertMapping) (GetInvertMappingResponse, error)             // metadata.getInvertMapping
	GetJournalnew          func(ctx context.Context, args GetJournalnew) (GetJournalResponsenew, error)                   // metadata.getJournalnew
	GetMapping             func(ctx context.Context, args GetMapping) (GetMappingResponse, error)                         // metadata.getMapping
	GetMetrics             func(ctx context.Context, args GetMetrics) (GetMetricsResponse, error)                         // metadata.getMetrics
	GetNewMappings         func(ctx context.Context, args GetNewMappings) (GetNewMappingsResponse, error)                 // metadata.getNewMappings
	GetTagMappingBootstrap func(ctx context.Context, args GetTagMappingBootstrap) (GetTagMappingBootstrap__Result, error) // metadata.getTagMappingBootstrap
	PutMapping             func(ctx context.Context, args PutMapping) (PutMappingResponse, error)                         // metadata.putMapping
	PutTagMappingBootstrap func(ctx context.Context, args PutTagMappingBootstrap) (PutTagMappingBootstrap__Result, error) // metadata.putTagMappingBootstrap
	ResetFlood             func(ctx context.Context, args ResetFlood) (ResetFloodResponse, error)                         // metadata.resetFlood
	ResetFlood2            func(ctx context.Context, args ResetFlood2) (ResetFloodResponse2, error)                       // metadata.resetFlood2

	RawEditEntitynew          func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.editEntitynew
	RawGetEntity              func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.getEntity
	RawGetHistoryShortInfo    func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.getHistoryShortInfo
	RawGetInvertMapping       func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.getInvertMapping
	RawGetJournalnew          func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.getJournalnew
	RawGetMapping             func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.getMapping
	RawGetMetrics             func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.getMetrics
	RawGetNewMappings         func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.getNewMappings
	RawGetTagMappingBootstrap func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.getTagMappingBootstrap
	RawPutMapping             func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.putMapping
	RawPutTagMappingBootstrap func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.putTagMappingBootstrap
	RawResetFlood             func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.resetFlood
	RawResetFlood2            func(ctx context.Context, hctx *rpc.HandlerContext) error // metadata.resetFlood2
}

func (h *Handler) Handle(ctx context.Context, hctx *rpc.HandlerContext) (err error) {
	tag, r, _ := basictl.NatReadTag(hctx.Request) // keep hctx.Request intact for handler chaining
	switch tag {
	case 0x86df475f: // metadata.editEntitynew
		hctx.SetRequestFunctionName("metadata.editEntitynew")
		if h.RawEditEntitynew != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawEditEntitynew(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.editEntitynew", err)
			}
			return nil
		}
		if h.EditEntitynew != nil {
			var args EditEntitynew
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.editEntitynew", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.EditEntitynew(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.editEntitynew", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.editEntitynew", err)
			}
			return nil
		}
	case 0x72b132f8: // metadata.getEntity
		hctx.SetRequestFunctionName("metadata.getEntity")
		if h.RawGetEntity != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawGetEntity(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getEntity", err)
			}
			return nil
		}
		if h.GetEntity != nil {
			var args GetEntity
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.getEntity", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.GetEntity(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getEntity", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.getEntity", err)
			}
			return nil
		}
	case 0x22ff6a79: // metadata.getHistoryShortInfo
		hctx.SetRequestFunctionName("metadata.getHistoryShortInfo")
		if h.RawGetHistoryShortInfo != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawGetHistoryShortInfo(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getHistoryShortInfo", err)
			}
			return nil
		}
		if h.GetHistoryShortInfo != nil {
			var args GetHistoryShortInfo
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.getHistoryShortInfo", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.GetHistoryShortInfo(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getHistoryShortInfo", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.getHistoryShortInfo", err)
			}
			return nil
		}
	case 0x9faf5280: // metadata.getInvertMapping
		hctx.SetRequestFunctionName("metadata.getInvertMapping")
		if h.RawGetInvertMapping != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawGetInvertMapping(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getInvertMapping", err)
			}
			return nil
		}
		if h.GetInvertMapping != nil {
			var args GetInvertMapping
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.getInvertMapping", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.GetInvertMapping(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getInvertMapping", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.getInvertMapping", err)
			}
			return nil
		}
	case 0x93ba92f8: // metadata.getJournalnew
		hctx.SetRequestFunctionName("metadata.getJournalnew")
		if h.RawGetJournalnew != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawGetJournalnew(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getJournalnew", err)
			}
			return nil
		}
		if h.GetJournalnew != nil {
			var args GetJournalnew
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.getJournalnew", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.GetJournalnew(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getJournalnew", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.getJournalnew", err)
			}
			return nil
		}
	case 0x9dfa7a83: // metadata.getMapping
		hctx.SetRequestFunctionName("metadata.getMapping")
		if h.RawGetMapping != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawGetMapping(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getMapping", err)
			}
			return nil
		}
		if h.GetMapping != nil {
			var args GetMapping
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.getMapping", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.GetMapping(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getMapping", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.getMapping", err)
			}
			return nil
		}
	case 0x93ba92f5: // metadata.getMetrics
		hctx.SetRequestFunctionName("metadata.getMetrics")
		if h.RawGetMetrics != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawGetMetrics(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getMetrics", err)
			}
			return nil
		}
		if h.GetMetrics != nil {
			var args GetMetrics
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.getMetrics", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.GetMetrics(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getMetrics", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.getMetrics", err)
			}
			return nil
		}
	case 0x93ba92f7: // metadata.getNewMappings
		hctx.SetRequestFunctionName("metadata.getNewMappings")
		if h.RawGetNewMappings != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawGetNewMappings(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getNewMappings", err)
			}
			return nil
		}
		if h.GetNewMappings != nil {
			var args GetNewMappings
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.getNewMappings", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.GetNewMappings(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getNewMappings", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.getNewMappings", err)
			}
			return nil
		}
	case 0x5fc81a9b: // metadata.getTagMappingBootstrap
		hctx.SetRequestFunctionName("metadata.getTagMappingBootstrap")
		if h.RawGetTagMappingBootstrap != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawGetTagMappingBootstrap(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getTagMappingBootstrap", err)
			}
			return nil
		}
		if h.GetTagMappingBootstrap != nil {
			var args GetTagMappingBootstrap
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.getTagMappingBootstrap", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.GetTagMappingBootstrap(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.getTagMappingBootstrap", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.getTagMappingBootstrap", err)
			}
			return nil
		}
	case 0x9faf5281: // metadata.putMapping
		hctx.SetRequestFunctionName("metadata.putMapping")
		if h.RawPutMapping != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawPutMapping(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.putMapping", err)
			}
			return nil
		}
		if h.PutMapping != nil {
			var args PutMapping
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.putMapping", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.PutMapping(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.putMapping", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.putMapping", err)
			}
			return nil
		}
	case 0x5fc8ab9b: // metadata.putTagMappingBootstrap
		hctx.SetRequestFunctionName("metadata.putTagMappingBootstrap")
		if h.RawPutTagMappingBootstrap != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawPutTagMappingBootstrap(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.putTagMappingBootstrap", err)
			}
			return nil
		}
		if h.PutTagMappingBootstrap != nil {
			var args PutTagMappingBootstrap
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.putTagMappingBootstrap", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.PutTagMappingBootstrap(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.putTagMappingBootstrap", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.putTagMappingBootstrap", err)
			}
			return nil
		}
	case 0x9faf5282: // metadata.resetFlood
		hctx.SetRequestFunctionName("metadata.resetFlood")
		if h.RawResetFlood != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawResetFlood(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.resetFlood", err)
			}
			return nil
		}
		if h.ResetFlood != nil {
			var args ResetFlood
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.resetFlood", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.ResetFlood(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.resetFlood", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.resetFlood", err)
			}
			return nil
		}
	case 0x88d0fd5e: // metadata.resetFlood2
		hctx.SetRequestFunctionName("metadata.resetFlood2")
		if h.RawResetFlood2 != nil && !hctx.BodyFormatTL2() {
			hctx.Request = r
			err = h.RawResetFlood2(ctx, hctx)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.resetFlood2", err)
			}
			return nil
		}
		if h.ResetFlood2 != nil {
			var args ResetFlood2
			if hctx.BodyFormatTL2() {
				tctx := basictl.TL2ReadContext{}
				_, err = args.ReadTL2(r, &tctx)
			} else {
				_, err = args.Read(r)
			}
			if err != nil {
				return internal.ErrorServerRead("metadata.resetFlood2", err)
			}
			ctx = hctx.WithContext(ctx)
			ret, err := h.ResetFlood2(ctx, args)
			if hctx.LongpollStarted() || rpc.IsLongpollResponse(err) {
				return err
			}
			if err != nil {
				return internal.ErrorServerHandle("metadata.resetFlood2", err)
			}
			hctx.Response, err = args.WriteResult(hctx.Response, ret)
			if err != nil {
				return internal.ErrorServerWriteResult("metadata.resetFlood2", err)
			}
			return nil
		}
	}
	return rpc.ErrNoHandler
}
